#!/bin/bash

# Post-update hook to restore customizations after Omarchy updates
# Place this in ~/.config/omarchy/hooks/post-update

echo "üîÑ Restoring customizations after Omarchy update..."

# Restore modified scripts if they exist
BACKUP_DIR="$HOME/omarchy-setup/backup-scripts"
LOCAL_BIN="$HOME/.local/share/omarchy/bin"

if [[ -f "$BACKUP_DIR/omarchy-launch-screensaver" ]]; then
    echo "üìã Restoring omarchy-launch-screensaver..."
    cp "$BACKUP_DIR/omarchy-launch-screensaver" "$LOCAL_BIN/"
fi

# Restore configurations from repo if they exist
if [[ -f "$HOME/omarchy-setup/configs/hypr/autostart.conf" ]]; then
    echo "‚öôÔ∏è Restoring custom autostart configuration..."
    cp "$HOME/omarchy-setup/configs/hypr/autostart.conf" "$HOME/.config/hypr/"
fi

if [[ -f "$HOME/omarchy-setup/configs/hypr/bindings.conf" ]]; then
    echo "‚å®Ô∏è Restoring custom keybindings..."
    cp "$HOME/omarchy-setup/configs/hypr/bindings.conf" "$HOME/.config/hypr/"
fi

if [[ -f "$HOME/omarchy-setup/configs/hypr/hypridle.conf" ]]; then
    echo "‚è±Ô∏è Restoring custom idle configuration..."
    cp "$HOME/omarchy-setup/configs/hypr/hypridle.conf" "$HOME/.config/hypr/"
fi

if [[ -f "$HOME/omarchy-setup/configs/hypr/hyprlock.conf" ]]; then
    echo "üîí Restoring custom lock screen configuration..."
    cp "$HOME/omarchy-setup/configs/hypr/hyprlock.conf" "$HOME/.config/hypr/"
fi

# Restore custom screensaver launcher
if [[ -f "$HOME/omarchy-setup/configs/hypr/scripts/custom-screensaver-launch.sh" ]]; then
    echo "üé¨ Restoring custom screensaver launcher..."
    mkdir -p "$HOME/.config/hypr/scripts"
    cp "$HOME/omarchy-setup/configs/hypr/scripts/custom-screensaver-launch.sh" "$HOME/.config/hypr/scripts/"
    chmod +x "$HOME/.config/hypr/scripts/custom-screensaver-launch.sh"
fi



echo "‚úÖ Customizations restored successfully!"